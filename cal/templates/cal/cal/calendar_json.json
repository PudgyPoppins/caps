{% load custom_filters %}
[
	{% if calendar.networkcal.all %}
	{% for noncal in calendar.networkcal.all %}
	{% for i in noncal.event.all %}
	{% for j in i.instance.all %}
	{
		{% include 'cal/snippets/snippet.json' with i=j %}
	},
	{% endfor %}

	{
		{% include 'cal/snippets/snippet.json' with i=i %}
	}{% if forloop.counter != noncal.event.count|multiply:calendar.networkcal.count and calendar.event.all %},{% endif %}

	{% endfor %}
	{% endfor %}
	{% endif %}

	{% if calendar.event.all %}
	{% for i in calendar.event.all %}

	{% for j in i.instance.all %}
	{
		{% include 'cal/snippets/snippet.json' with i=j %}
	},
	{% endfor %}

	{
		{% include 'cal/snippets/snippet.json' with i=i %}
	}{% if forloop.counter != calendar.event.count %},{% endif %}

	{% endfor %}
	{% endif %}
]